<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <title>Admin Page</title>
  </head>
  <body>
    <link rel="stylesheet" href="styles.css" />
    <div class="container mt-5">
      <div class="row">
        <div class="col-12 col-lg-3"></div>
        <div class="col-12 col-lg-6 text-center box">
          <h1 class="">Tournament Management</h1>

          <label class="mt-3">Tournament Name: </label>
          <span id="tournamentName">Loading...</span>

          <div style="display: flex" class="mt-5">
            <button
              class="btn btn-primary w-50 mx-2"
              onclick="handleModal('modalCuartos')"
              id="I_Cuartos"
            >
              Cargar jugadores a Cuartos
            </button>

            <button
              class="btn btn-secondary w-50 mx-2"
              onclick="handleModal('brackets')"
              id="handleGames"
            >
              Manejar partidos
            </button>
          </div>

          <button class="btn btn-secondary w-50 mx-2 mt-3" id="apuestas">
            Panel de Apuestas
          </button>

          <!-- New Buttons -->
          <button class="btn btn-success w-50 mx-2 mt-3" id="activarApuestas">
            Activar apuestas
          </button>

          <button class="btn btn-danger w-50 mx-2 mt-3" id="desactivarApuestas">
            Desactivar apuestas
          </button>

          <button class="btn btn-primary w-50 mx-2 mt-3" id="activarBracket">
            Activar Bracket
          </button>
        </div>
        <div class="col-12 col-lg-3"></div>
      </div>
    </div>

    <!-- MODAL ACTIVAR BRACKET -->
    <div class="container-fluid modalCont" id="modalActivarBracket">
      <div class="row modalBox">
        <div class="col-12 text-center mt-3">
          <h1>Activar Bracket</h1>
        </div>
        <div class="col-12 text-center mt-3">
          <button id="cuartos" class="w-50 py-2 mt-0 mb-0">Cuartos</button>
        </div>
        <div class="col-12 text-center mt-3">
          <button id="semis" class="w-50 py-2 mt-0 mb-0">Semifinales</button>
        </div>
        <div class="col-12 text-center mt-3">
          <button id="finales" class="w-50 py-2 mt-0 mb-0">Finales</button>
        </div>
        <div class="col-12 text-center mt-3">
          <button id="ningun" class="w-50 py-2 mt-0 mb-0">
            Ningun Bracket esta activo
          </button>
        </div>
        <div class="col-12 text-center mt-3">
          <button
            id="cerrarModalActivarBracket"
            class="w-25 mt-4 btn btn-secondary w-50"
          >
            Cerrar
          </button>
        </div>
      </div>
    </div>

    <script type="module">
      import {
        activarApuestas,
        desactivarApuestas,
        activateBracketButton,
      } from "./tournamentManagment.js";

      // Define handleModal
      let handleModal = (id) => {
        let modal = document.getElementById(id);
        if (getComputedStyle(modal).display === "none") {
          modal.style.display = "block";
        } else {
          modal.style.display = "none";
        }
      };

      // Ensure event listeners are added after the DOM is fully loaded
      document.addEventListener("DOMContentLoaded", () => {
        // Add event listeners for new buttons
        const activarApuestasBtn = document.getElementById("activarApuestas");
        if (activarApuestasBtn) {
          activarApuestasBtn.addEventListener("click", activarApuestas);
        }

        const desactivarApuestasBtn =
          document.getElementById("desactivarApuestas");
        if (desactivarApuestasBtn) {
          desactivarApuestasBtn.addEventListener("click", desactivarApuestas);
        }

        const cuartosBtn = document.getElementById("cuartos");
        if (cuartosBtn) {
          cuartosBtn.addEventListener("click", () =>
            activateBracketButton("cuartos")
          );
        }

        const semisBtn = document.getElementById("semis");
        if (semisBtn) {
          semisBtn.addEventListener("click", () =>
            activateBracketButton("semis")
          );
        }

        const finalesBtn = document.getElementById("finales");
        if (finalesBtn) {
          finalesBtn.addEventListener("click", () =>
            activateBracketButton("finales")
          );
        }

        const ningunBtn = document.getElementById("ningun");
        if (ningunBtn) {
          ningunBtn.addEventListener("click", () => activateBracketButton(""));
        }

        const activarBracketBtn = document.getElementById("activarBracket");
        if (activarBracketBtn) {
          activarBracketBtn.addEventListener("click", () =>
            handleModal("modalActivarBracket")
          );
        }

        const cerrarModalBtn = document.getElementById(
          "cerrarModalActivarBracket"
        );
        if (cerrarModalBtn) {
          cerrarModalBtn.addEventListener("click", () =>
            handleModal("modalActivarBracket")
          );
        }

        const apuestasBtn = document.getElementById("apuestas");
        if (apuestasBtn) {
          apuestasBtn.addEventListener("click", () => {
            window.location.href = "bets.html";
          });
        }
      });
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
      integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
